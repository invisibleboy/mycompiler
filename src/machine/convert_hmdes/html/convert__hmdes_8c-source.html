<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>convert_hmdes: convert_hmdes.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>convert_hmdes.c</h1><a href="convert__hmdes_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> *                    Illinois Open Source License</span>
<a name="l00004"></a>00004 <span class="comment"> *                     University of Illinois/NCSA</span>
<a name="l00005"></a>00005 <span class="comment"> *                         Open Source License</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * Copyright (c) 2004, The University of Illinois at Urbana-Champaign.</span>
<a name="l00008"></a>00008 <span class="comment"> * All rights reserved.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * Developed by:             </span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> *              IMPACT Research Group</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> *              University of Illinois at Urbana-Champaign</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *              http://www.crhc.uiuc.edu/IMPACT</span>
<a name="l00017"></a>00017 <span class="comment"> *              http://www.gelato.org</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * Permission is hereby granted, free of charge, to any person</span>
<a name="l00020"></a>00020 <span class="comment"> * obtaining a copy of this software and associated documentation</span>
<a name="l00021"></a>00021 <span class="comment"> * files (the "Software"), to deal with the Software without</span>
<a name="l00022"></a>00022 <span class="comment"> * restriction, including without limitation the rights to use, copy,</span>
<a name="l00023"></a>00023 <span class="comment"> * modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<a name="l00024"></a>00024 <span class="comment"> * of the Software, and to permit persons to whom the Software is</span>
<a name="l00025"></a>00025 <span class="comment"> * furnished to do so, subject to the following conditions:</span>
<a name="l00026"></a>00026 <span class="comment"> *</span>
<a name="l00027"></a>00027 <span class="comment"> * Redistributions of source code must retain the above copyright</span>
<a name="l00028"></a>00028 <span class="comment"> * notice, this list of conditions and the following disclaimers.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00031"></a>00031 <span class="comment"> * notice, this list of conditions and the following disclaimers in</span>
<a name="l00032"></a>00032 <span class="comment"> * the documentation and/or other materials provided with the</span>
<a name="l00033"></a>00033 <span class="comment"> * distribution.</span>
<a name="l00034"></a>00034 <span class="comment"> *</span>
<a name="l00035"></a>00035 <span class="comment"> * Neither the names of the IMPACT Research Group, the University of</span>
<a name="l00036"></a>00036 <span class="comment"> * Illinois, nor the names of its contributors may be used to endorse</span>
<a name="l00037"></a>00037 <span class="comment"> * or promote products derived from this Software without specific</span>
<a name="l00038"></a>00038 <span class="comment"> * prior written permission.  THE SOFTWARE IS PROVIDED "AS IS",</span>
<a name="l00039"></a>00039 <span class="comment"> * WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT</span>
<a name="l00040"></a>00040 <span class="comment"> * LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A</span>
<a name="l00041"></a>00041 <span class="comment"> * PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE</span>
<a name="l00042"></a>00042 <span class="comment"> * CONTRIBUTORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES</span>
<a name="l00043"></a>00043 <span class="comment"> * OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR</span>
<a name="l00044"></a>00044 <span class="comment"> * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE</span>
<a name="l00045"></a>00045 <span class="comment"> * OR THE USE OR OTHER DEALINGS WITH THE SOFTWARE.</span>
<a name="l00046"></a>00046 <span class="comment"> *</span>
<a name="l00047"></a>00047 <span class="comment">\*****************************************************************************/</span>
<a name="l00048"></a>00048 <span class="comment">/*****************************************************************************\</span>
<a name="l00049"></a>00049 <span class="comment"> *      File:   convert_hmdes.c</span>
<a name="l00050"></a>00050 <span class="comment"> *              Converts hmdes version1 file to a (barely) usable hmdes </span>
<a name="l00051"></a>00051 <span class="comment"> *              version2 files</span>
<a name="l00052"></a>00052 <span class="comment"> * </span>
<a name="l00053"></a>00053 <span class="comment"> *      Author: John C. Gyllenhaal, Wen-mei Hwu</span>
<a name="l00054"></a>00054 <span class="comment"> *      Creation Date:  February 1996</span>
<a name="l00055"></a>00055 <span class="comment">\*****************************************************************************/</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">/* 10/29/02 REK Adding config.h */</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;config.h&gt;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;library/md.h&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;machine/hmdes.h&gt;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="keyword">extern</span> <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structheader__file__st.html">Header_File</a> <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#532fef42f980f82744b7a6cfd1999548">header_table</a>[];
<a name="l00068"></a>00068 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#1771c66351c3c7fd849af851b3e31455">num_header_files</a>;
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="convert__hmdes_8c.html#289c5900d90626d909f0a85d5a0ed61d">00070</a> <span class="keywordtype">char</span> *<a class="code" href="convert__hmdes_8c.html#289c5900d90626d909f0a85d5a0ed61d">program_name</a>;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="keywordtype">void</span>
<a name="l00073"></a><a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">00073</a> <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="keywordtype">char</span> *fmt, ...)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075   va_list args;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   fprintf (stderr, <span class="stringliteral">"Error converting hmdes version1 to version2:\n"</span>);
<a name="l00078"></a>00078   va_start (args, fmt);
<a name="l00079"></a>00079   vfprintf (stderr, fmt, args);
<a name="l00080"></a>00080   va_end (args);
<a name="l00081"></a>00081   fprintf (stderr, <span class="stringliteral">"\n"</span>);
<a name="l00082"></a>00082   exit (-1);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <span class="keywordflow">return</span>;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="keywordtype">void</span>
<a name="l00088"></a><a class="code" href="convert__hmdes_8c.html#e5ad5cbeccaedc03a48d3c7eaa803e79">00088</a> <a class="code" href="convert__hmdes_8c.html#e5ad5cbeccaedc03a48d3c7eaa803e79">print_usage</a> ()
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090   fprintf (stderr,
<a name="l00091"></a>00091            <span class="stringliteral">"usage: %s hmdes_file_name structure_IMPACT.lmdes2 "</span>
<a name="l00092"></a>00092            <span class="stringliteral">"hmdes2_file_name [-Dname=value] [-verbose]\n"</span>, <a class="code" href="convert__hmdes_8c.html#289c5900d90626d909f0a85d5a0ed61d">program_name</a>);
<a name="l00093"></a>00093   exit (1);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <span class="keywordflow">return</span>;
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="comment">/* Return entry's pointer and creates entry if necessary */</span>
<a name="l00100"></a>00100 <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *
<a name="l00101"></a><a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">00101</a> <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <span class="keywordtype">char</span> *section_name, <span class="keywordtype">char</span> *entry_name)
<a name="l00102"></a>00102 {
<a name="l00103"></a>00103   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Section.html">MD_Section</a> *section;
<a name="l00104"></a>00104   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106   <span class="comment">/* Find the section in the md */</span>
<a name="l00107"></a>00107   <span class="keywordflow">if</span> ((section = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ea84fd9204301dda7014a2374251db76">MD_find_section</a> (md, section_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00108"></a>00108     {
<a name="l00109"></a>00109       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Unable to find section '%s' in '%s'"</span>,
<a name="l00110"></a>00110               section_name, entry_name);
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="comment">/* Add entry if not already there */</span>
<a name="l00114"></a>00114   <span class="keywordflow">if</span> ((<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a> = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ed997dd6e6244f22cfadf1befbd1a630">MD_find_entry</a> (section, entry_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00115"></a>00115     {
<a name="l00116"></a>00116       <span class="keywordflow">return</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#9f8fe13898aae1fcebba90fa026a3318">MD_new_entry</a> (section, entry_name));
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118   <span class="keywordflow">return</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>);
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="comment">/* Return's entry's pointer, returns NULL if not found */</span>
<a name="l00122"></a>00122 <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *
<a name="l00123"></a><a class="code" href="convert__hmdes_8c.html#34bf787819d11144e052c7527984718a">00123</a> <a class="code" href="convert__hmdes_8c.html#34bf787819d11144e052c7527984718a">find_entry_if_exists</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <span class="keywordtype">char</span> *section_name, <span class="keywordtype">char</span> *entry_name)
<a name="l00124"></a>00124 {
<a name="l00125"></a>00125   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Section.html">MD_Section</a> *section;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   <span class="comment">/* Find the section in the md */</span>
<a name="l00128"></a>00128   <span class="keywordflow">if</span> ((section = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ea84fd9204301dda7014a2374251db76">MD_find_section</a> (md, section_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00129"></a>00129     {
<a name="l00130"></a>00130       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Unable to find section '%s' in '%s'"</span>,
<a name="l00131"></a>00131               section_name, entry_name);
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="comment">/* Return entry name or NULL */</span>
<a name="l00135"></a>00135   <span class="keywordflow">return</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ed997dd6e6244f22cfadf1befbd1a630">MD_find_entry</a> (section, entry_name));
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">/* Return entry's pointer, punt if not found */</span>
<a name="l00140"></a>00140 <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *
<a name="l00141"></a><a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">00141</a> <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <span class="keywordtype">char</span> *section_name, <span class="keywordtype">char</span> *entry_name)
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Section.html">MD_Section</a> *section;
<a name="l00144"></a>00144   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="comment">/* Find the section in the md */</span>
<a name="l00147"></a>00147   <span class="keywordflow">if</span> ((section = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ea84fd9204301dda7014a2374251db76">MD_find_section</a> (md, section_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00148"></a>00148     {
<a name="l00149"></a>00149       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Unable to find section '%s' in '%s'"</span>, section_name, md-&gt;name);
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">/* Punt if entry not found */</span>
<a name="l00153"></a>00153   <span class="keywordflow">if</span> ((<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a> = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ed997dd6e6244f22cfadf1befbd1a630">MD_find_entry</a> (section, entry_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00154"></a>00154     {
<a name="l00155"></a>00155       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"find_entry: %s-&gt;%s not found\n"</span>, section_name, entry_name);
<a name="l00156"></a>00156     }
<a name="l00157"></a>00157   <span class="keywordflow">return</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>);
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">/* Adds a value to an entry's field.  Creates the field if necessary */</span>
<a name="l00161"></a>00161 <span class="keywordtype">void</span>
<a name="l00162"></a><a class="code" href="convert__hmdes_8c.html#26b31203d2cfec0406e930f19e4d534f">00162</a> <a class="code" href="convert__hmdes_8c.html#26b31203d2cfec0406e930f19e4d534f">add_value_to_field</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> * <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>, <span class="keywordtype">char</span> *field_name, <span class="keywordtype">int</span> index,
<a name="l00163"></a>00163                     <span class="keywordtype">int</span> type, <span class="keywordtype">void</span> *value)
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field__Decl.html">MD_Field_Decl</a> *field_decl;
<a name="l00166"></a>00166   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field.html">MD_Field</a> *field;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   <span class="comment">/* Get Field declaration */</span>
<a name="l00169"></a>00169   <span class="keywordflow">if</span> ((field_decl = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#10402535f4e3b94b1e0d75ca22cd9eae">MD_find_field_decl</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;section, field_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00170"></a>00170     {
<a name="l00171"></a>00171       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"%s-&gt;%s: Field '%s' undefined.\n"</span>,
<a name="l00172"></a>00172               <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;section-&gt;name, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;name, field_name);
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   <span class="comment">/* Create field if not already present */</span>
<a name="l00176"></a>00176   <span class="keywordflow">if</span> ((field = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1124821854f50740cfaecb6394234b80">MD_find_field</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>, field_decl)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00177"></a>00177     {
<a name="l00178"></a>00178       field = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#fbc882977f12979165e7d5903d2272be">MD_new_field</a> (entry, field_decl, 0);
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181   <span class="comment">/* Set field to specified value */</span>
<a name="l00182"></a>00182   <span class="keywordflow">switch</span> (type)
<a name="l00183"></a>00183     {
<a name="l00184"></a>00184     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1bae96f31ca512cf27a95ab6f96f4d89">MD_INT</a>:
<a name="l00185"></a>00185       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#d3609a2cbc1a05b0cffb684d3dbbd573">MD_set_int</a> (field, index, *((<span class="keywordtype">int</span> *) value));
<a name="l00186"></a>00186       <span class="keywordflow">break</span>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#d613c66d34f25d733291ba6118f1e2cd">MD_DOUBLE</a>:
<a name="l00189"></a>00189       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#c47e98c68b31487a4b7958ca8be2f337">MD_set_double</a> (field, index, *((<span class="keywordtype">double</span> *) value));
<a name="l00190"></a>00190       <span class="keywordflow">break</span>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#00aaba1fc61d6e7046112b9477287b70">MD_STRING</a>:
<a name="l00193"></a>00193       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ce4e2520515e16050f27d7b86196e82a">MD_set_string</a> (field, index, (<span class="keywordtype">char</span> *) value);
<a name="l00194"></a>00194       <span class="keywordflow">break</span>;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>:
<a name="l00197"></a>00197       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#c1642c81252810b1792fac58dfb79777">MD_set_link</a> (field, index, (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *) value);
<a name="l00198"></a>00198       <span class="keywordflow">break</span>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="keywordflow">default</span>:
<a name="l00201"></a>00201       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"add_value_to_field: Unknown type '%i'!"</span>, type);
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="comment">/* Create an empty field */</span>
<a name="l00207"></a>00207 <span class="keywordtype">void</span>
<a name="l00208"></a><a class="code" href="convert__hmdes_8c.html#51b19f66e703ea6bc42975c17d0f56f8">00208</a> <a class="code" href="convert__hmdes_8c.html#51b19f66e703ea6bc42975c17d0f56f8">create_empty_field</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> * <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>, <span class="keywordtype">char</span> *field_name)
<a name="l00209"></a>00209 {
<a name="l00210"></a>00210   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field__Decl.html">MD_Field_Decl</a> *field_decl;
<a name="l00211"></a>00211   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field.html">MD_Field</a> *field;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <span class="comment">/* Get Field declaration */</span>
<a name="l00214"></a>00214   <span class="keywordflow">if</span> ((field_decl = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#10402535f4e3b94b1e0d75ca22cd9eae">MD_find_field_decl</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;section, field_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00215"></a>00215     {
<a name="l00216"></a>00216       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"%s-&gt;%s: Field '%s' undefined.\n"</span>,
<a name="l00217"></a>00217               <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;section-&gt;name, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;name, field_name);
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220   <span class="comment">/* Create field if not already present */</span>
<a name="l00221"></a>00221   <span class="keywordflow">if</span> ((field = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1124821854f50740cfaecb6394234b80">MD_find_field</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>, field_decl)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00222"></a>00222     {
<a name="l00223"></a>00223       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#fbc882977f12979165e7d5903d2272be">MD_new_field</a> (entry, field_decl, 0);
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">/* Append a value to the end of an entry's field. </span>
<a name="l00228"></a>00228 <span class="comment"> * Creates the field if necessary </span>
<a name="l00229"></a>00229 <span class="comment"> */</span>
<a name="l00230"></a>00230 <span class="keywordtype">void</span>
<a name="l00231"></a><a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">00231</a> <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> * <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>, <span class="keywordtype">char</span> *field_name,
<a name="l00232"></a>00232                        <span class="keywordtype">int</span> type, <span class="keywordtype">void</span> *value)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field__Decl.html">MD_Field_Decl</a> *field_decl;
<a name="l00235"></a>00235   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field.html">MD_Field</a> *field;
<a name="l00236"></a>00236   <span class="keywordtype">int</span> index;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   <span class="comment">/* Get Field declaration */</span>
<a name="l00239"></a>00239   <span class="keywordflow">if</span> ((field_decl = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#10402535f4e3b94b1e0d75ca22cd9eae">MD_find_field_decl</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;section, field_name)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00240"></a>00240     {
<a name="l00241"></a>00241       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"%s-&gt;%s: Field '%s' undefined.\n"</span>,
<a name="l00242"></a>00242               <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;section-&gt;name, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>-&gt;name, field_name);
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   <span class="comment">/* Create field if not already present */</span>
<a name="l00246"></a>00246   <span class="keywordflow">if</span> ((field = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1124821854f50740cfaecb6394234b80">MD_find_field</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>, field_decl)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00247"></a>00247     {
<a name="l00248"></a>00248       field = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#fbc882977f12979165e7d5903d2272be">MD_new_field</a> (entry, field_decl, 0);
<a name="l00249"></a>00249       index = 0;
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251   <span class="keywordflow">else</span>
<a name="l00252"></a>00252     {
<a name="l00253"></a>00253       index = field-&gt;<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Field.html#2b91ce290e95ee2fc51af43930c4501f">max_element_index</a> + 1;
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256   <span class="comment">/* Set field to specified value */</span>
<a name="l00257"></a>00257   <span class="keywordflow">switch</span> (type)
<a name="l00258"></a>00258     {
<a name="l00259"></a>00259     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1bae96f31ca512cf27a95ab6f96f4d89">MD_INT</a>:
<a name="l00260"></a>00260       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#d3609a2cbc1a05b0cffb684d3dbbd573">MD_set_int</a> (field, index, *((<span class="keywordtype">int</span> *) value));
<a name="l00261"></a>00261       <span class="keywordflow">break</span>;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#d613c66d34f25d733291ba6118f1e2cd">MD_DOUBLE</a>:
<a name="l00264"></a>00264       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#c47e98c68b31487a4b7958ca8be2f337">MD_set_double</a> (field, index, *((<span class="keywordtype">double</span> *) value));
<a name="l00265"></a>00265       <span class="keywordflow">break</span>;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#00aaba1fc61d6e7046112b9477287b70">MD_STRING</a>:
<a name="l00268"></a>00268       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#ce4e2520515e16050f27d7b86196e82a">MD_set_string</a> (field, index, (<span class="keywordtype">char</span> *) value);
<a name="l00269"></a>00269       <span class="keywordflow">break</span>;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="keywordflow">case</span> <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>:
<a name="l00272"></a>00272       <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#c1642c81252810b1792fac58dfb79777">MD_set_link</a> (field, index, (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *) value);
<a name="l00273"></a>00273       <span class="keywordflow">break</span>;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keywordflow">default</span>:
<a name="l00276"></a>00276       <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"append_value_to_field: Unknown type '%i'!"</span>, type);
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 <span class="comment">/* Create processor_model and customization_header parameters */</span>
<a name="l00281"></a>00281 <span class="keywordtype">void</span>
<a name="l00282"></a><a class="code" href="convert__hmdes_8c.html#f202962df85bdaaedd37e868417af372">00282</a> <a class="code" href="convert__hmdes_8c.html#f202962df85bdaaedd37e868417af372">convert_Parameters</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> * hmdes)
<a name="l00283"></a>00283 {
<a name="l00284"></a>00284   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *parm;
<a name="l00285"></a>00285   <span class="keywordtype">int</span> i;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="comment">/* Add processor model */</span>
<a name="l00288"></a>00288   parm = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Parameter"</span>, <span class="stringliteral">"processor_model"</span>);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   <span class="keywordflow">if</span> (hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#90cd9923c96e9175630409e9fd7e9ff4">processor_model</a> == <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8h.html#2202ce53709c0e408a63030c29fead58">MDES_SUPERSCALAR</a>)
<a name="l00291"></a>00291     <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (parm, <span class="stringliteral">"value"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#00aaba1fc61d6e7046112b9477287b70">MD_STRING</a>, <span class="stringliteral">"superscalar"</span>);
<a name="l00292"></a>00292   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#90cd9923c96e9175630409e9fd7e9ff4">processor_model</a> == <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8h.html#1dd3b99b38350ea5ad6a1ae70624f7a4">MDES_VLIW</a>)
<a name="l00293"></a>00293     <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (parm, <span class="stringliteral">"value"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#00aaba1fc61d6e7046112b9477287b70">MD_STRING</a>, <span class="stringliteral">"vliw"</span>);
<a name="l00294"></a>00294   <span class="keywordflow">else</span>
<a name="l00295"></a>00295     <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Unknown processor model :%i\n"</span>, hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#90cd9923c96e9175630409e9fd7e9ff4">processor_model</a>);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 
<a name="l00298"></a>00298   <span class="comment">/* Fill in the header files to be used */</span>
<a name="l00299"></a>00299   parm = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Parameter"</span>, <span class="stringliteral">"customization_headers"</span>);
<a name="l00300"></a>00300   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#1771c66351c3c7fd849af851b3e31455">num_header_files</a>; i++)
<a name="l00301"></a>00301     {
<a name="l00302"></a>00302       <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (parm, <span class="stringliteral">"value"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#00aaba1fc61d6e7046112b9477287b70">MD_STRING</a>, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#532fef42f980f82744b7a6cfd1999548">header_table</a>[i].<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/struct@1.html#37bcc8711ce73b1674632b61832d13b2">name</a>);
<a name="l00303"></a>00303     }
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 <span class="comment">/* Returns 1 if name in the set's io_node list, 0 otherwise */</span>
<a name="l00307"></a>00307 <span class="keywordtype">int</span>
<a name="l00308"></a><a class="code" href="convert__hmdes_8c.html#b72910e402756bb494e73ff644d6a468">00308</a> <a class="code" href="convert__hmdes_8c.html#b72910e402756bb494e73ff644d6a468">in_set</a> (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> * set, <span class="keywordtype">char</span> *<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/struct@1.html#37bcc8711ce73b1674632b61832d13b2">name</a>)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html">Hmdes_IO_Node</a> *<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#69971143e908d3fc31e596632d5a4073">node</a>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   <span class="keywordflow">for</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#69971143e908d3fc31e596632d5a4073">node</a> = set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#4cea398cccec4faf9c0193326f443ed7">head</a>; <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#69971143e908d3fc31e596632d5a4073">node</a> != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#69971143e908d3fc31e596632d5a4073">node</a> = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#69971143e908d3fc31e596632d5a4073">node</a>-&gt;next)
<a name="l00313"></a>00313     {
<a name="l00314"></a>00314       <span class="comment">/* Return 1 if match found */</span>
<a name="l00315"></a>00315       <span class="keywordflow">if</span> (strcmp (name, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#69971143e908d3fc31e596632d5a4073">node</a>-&gt;reg_file-&gt;name) == 0)
<a name="l00316"></a>00316         <span class="keywordflow">return</span> (1);
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319   <span class="comment">/* If didn't find it, return 0 */</span>
<a name="l00320"></a>00320   <span class="keywordflow">return</span> (0);
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="comment">/* Determine if target should be added to source's compatable set.</span>
<a name="l00324"></a>00324 <span class="comment"> * Check that target not already in compatable set, and that all of</span>
<a name="l00325"></a>00325 <span class="comment"> * the targets io_nodes are in the source's io_nodes.</span>
<a name="l00326"></a>00326 <span class="comment"> * Returns 1 if should be added, 0 otherwise.</span>
<a name="l00327"></a>00327 <span class="comment"> */</span>
<a name="l00328"></a>00328 <span class="keywordtype">int</span>
<a name="l00329"></a><a class="code" href="convert__hmdes_8c.html#a1538bee109770d069d4df477d332a23">00329</a> <a class="code" href="convert__hmdes_8c.html#a1538bee109770d069d4df477d332a23">compatable_sets</a> (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> * src_set, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> * target_set)
<a name="l00330"></a>00330 {
<a name="l00331"></a>00331   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html">Hmdes_IO_Node</a> *target_node;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="comment">/* Don't add target_set if already in src set */</span>
<a name="l00334"></a>00334   <span class="keywordflow">if</span> (<a class="code" href="convert__hmdes_8c.html#b72910e402756bb494e73ff644d6a468">in_set</a> (src_set, target_set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>))
<a name="l00335"></a>00335     <span class="keywordflow">return</span> (0);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337   <span class="comment">/* Make sure all compatable register files of target are in source */</span>
<a name="l00338"></a>00338   <span class="keywordflow">for</span> (target_node = target_set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#4cea398cccec4faf9c0193326f443ed7">head</a>; target_node != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00339"></a>00339        target_node = target_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html#35fa6e1f8aae5172c6b8c2813d3cbbf0">next</a>)
<a name="l00340"></a>00340     {
<a name="l00341"></a>00341       <span class="comment">/* If not in src set, not compatable */</span>
<a name="l00342"></a>00342       <span class="keywordflow">if</span> (!<a class="code" href="convert__hmdes_8c.html#b72910e402756bb494e73ff644d6a468">in_set</a> (src_set, target_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html#5ad6671c5124be7d88edb918f88bedb8">reg_file</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__reg__file__st.html#22d8bf4afc93e6fcbf72a6ff44f0bb3f">name</a>))
<a name="l00343"></a>00343         <span class="keywordflow">return</span> (0);
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   <span class="comment">/* If got through all the above tests, must be compatable */</span>
<a name="l00347"></a>00347   <span class="keywordflow">return</span> (1);
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="comment">/* Create the operation and operand format entries */</span>
<a name="l00351"></a>00351 <span class="keywordtype">void</span>
<a name="l00352"></a><a class="code" href="convert__hmdes_8c.html#e050552b2cb01a9ba04eda87064a6e4e">00352</a> <a class="code" href="convert__hmdes_8c.html#e050552b2cb01a9ba04eda87064a6e4e">convert_format</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> * hmdes)
<a name="l00353"></a>00353 {
<a name="l00354"></a>00354   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html">Msymbol</a> *old_symbol, *old_target;
<a name="l00355"></a>00355   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> *io_set, *target_set;
<a name="l00356"></a>00356   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html">Hmdes_IO_Node</a> *io_node;
<a name="l00357"></a>00357   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html">Hmdes_IO_Item</a> *io_item;
<a name="l00358"></a>00358   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *field_type, *op_format, *target;
<a name="l00359"></a>00359   <span class="keywordtype">int</span> i;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <span class="comment">/* Add all io_sets to the Field_Type section */</span>
<a name="l00362"></a>00362   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#1a722007506b5a11845e3eb11113c90b">IO_sets</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00363"></a>00363        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00364"></a>00364     {
<a name="l00365"></a>00365       <span class="comment">/* Get old io_set for ease of use */</span>
<a name="l00366"></a>00366       io_set = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368       <span class="comment">/* Add to field type section */</span>
<a name="l00369"></a>00369       <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, io_set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>);
<a name="l00370"></a>00370     }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372   <span class="comment">/* Fill out the compatable_with field for all io_sets */</span>
<a name="l00373"></a>00373   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#1a722007506b5a11845e3eb11113c90b">IO_sets</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00374"></a>00374        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376       <span class="comment">/* Get old io_set for ease of use */</span>
<a name="l00377"></a>00377       io_set = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379       <span class="comment">/* find the to field type section */</span>
<a name="l00380"></a>00380       field_type = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, io_set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382       <span class="comment">/* Add all compatable register files */</span>
<a name="l00383"></a>00383       <span class="keywordflow">for</span> (io_node = io_set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#4cea398cccec4faf9c0193326f443ed7">head</a>; io_node != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; io_node = io_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html#35fa6e1f8aae5172c6b8c2813d3cbbf0">next</a>)
<a name="l00384"></a>00384         {
<a name="l00385"></a>00385           target = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, io_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__node__st.html#5ad6671c5124be7d88edb918f88bedb8">reg_file</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__reg__file__st.html#22d8bf4afc93e6fcbf72a6ff44f0bb3f">name</a>);
<a name="l00386"></a>00386           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (field_type, <span class="stringliteral">"compatible_with"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>,
<a name="l00387"></a>00387                                  target);
<a name="l00388"></a>00388         }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390       <span class="comment">/* Scan for other compatable field_types (non-register files) to</span>
<a name="l00391"></a>00391 <span class="comment">       * maintain same functionality of old mdes</span>
<a name="l00392"></a>00392 <span class="comment">       */</span>
<a name="l00393"></a>00393       <span class="keywordflow">for</span> (old_target = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#1a722007506b5a11845e3eb11113c90b">IO_sets</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_target != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00394"></a>00394            old_target = old_target-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00395"></a>00395         {
<a name="l00396"></a>00396           <span class="comment">/* Get old target_set for ease of use */</span>
<a name="l00397"></a>00397           target_set = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html">Hmdes_IO_Set</a> *) old_target-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399           <span class="comment">/* Add target set if compatable with this io set,</span>
<a name="l00400"></a>00400 <span class="comment">           * may add self to list (this is ok and probably makes the</span>
<a name="l00401"></a>00401 <span class="comment">           * translation more clear)</span>
<a name="l00402"></a>00402 <span class="comment">           */</span>
<a name="l00403"></a>00403           if (<a class="code" href="convert__hmdes_8c.html#a1538bee109770d069d4df477d332a23">compatable_sets</a> (io_set, target_set))
<a name="l00404"></a>00404             {
<a name="l00405"></a>00405               target = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, target_set-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>);
<a name="l00406"></a>00406               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (field_type, <span class="stringliteral">"compatible_with"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>,
<a name="l00407"></a>00407                                      target);
<a name="l00408"></a>00408             }
<a name="l00409"></a>00409         }
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="comment">/* Add all the IO_items to the Operation_Format section */</span>
<a name="l00413"></a>00413   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#54c0db7ebd19e2926d32d6e8fc5689f2">IO_items</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00414"></a>00414        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00415"></a>00415     {
<a name="l00416"></a>00416       <span class="comment">/* Get old io_item for ease of use */</span>
<a name="l00417"></a>00417       io_item = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html">Hmdes_IO_Item</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419       <span class="comment">/* Add to operation format section */</span>
<a name="l00420"></a>00420       op_format = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Operation_Format"</span>, io_item-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html#8607878410c73a0b45ee724f1eaebbbc">name</a>);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 
<a name="l00423"></a>00423       <span class="comment">/* Add all src, dest, and predicate field types */</span>
<a name="l00424"></a>00424       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#d13b429ef4ce57f85b6e50cfc7e89ba4">max_src_operands</a>; i++)
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426           target = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, io_item-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html#6c773db376d5ad314a5647ffae81239a">src</a>[i]-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>);
<a name="l00427"></a>00427           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_format, <span class="stringliteral">"src"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#6227b0dc332b781877c35fdbf23d3772">max_dest_operands</a>; i++)
<a name="l00431"></a>00431         {
<a name="l00432"></a>00432           target = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, io_item-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html#99e8bb66e9a127e08832eab0393be549">dest</a>[i]-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>);
<a name="l00433"></a>00433           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_format, <span class="stringliteral">"dest"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#d1234881901cd6f69caf80f4238f874f">max_pred_operands</a>; i++)
<a name="l00437"></a>00437         {
<a name="l00438"></a>00438           target = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Field_Type"</span>, io_item-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html#eeb833889fdf62378bef2f4f0e6d700a">pred</a>[i]-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__set__st.html#20fb123dd7e30a2e1c06aed923787f6d">name</a>);
<a name="l00439"></a>00439           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_format, <span class="stringliteral">"pred"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *
<a name="l00445"></a><a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">00445</a> <a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">add_op_lat</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <span class="keywordtype">char</span> *prefix, <span class="keywordtype">int</span> latency)
<a name="l00446"></a>00446 {
<a name="l00447"></a>00447   <span class="keywordtype">char</span> buf[50];
<a name="l00448"></a>00448   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>;
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   <span class="comment">/* Create latency name */</span>
<a name="l00451"></a>00451   sprintf (buf, <span class="stringliteral">"%s%i"</span>, prefix, latency);
<a name="l00452"></a>00452 
<a name="l00453"></a>00453   <span class="comment">/* If already exists, return pointer to existing entry */</span>
<a name="l00454"></a>00454   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a> = <a class="code" href="convert__hmdes_8c.html#34bf787819d11144e052c7527984718a">find_entry_if_exists</a> (md, <span class="stringliteral">"Operand_Latency"</span>, buf);
<a name="l00455"></a>00455   <span class="keywordflow">if</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a> != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00456"></a>00456     <span class="keywordflow">return</span> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/dataflow_8c.html#79617e393ed50f7bffa2de436e1f9c74">entry</a>);
<a name="l00457"></a>00457   <span class="keywordflow">else</span>
<a name="l00458"></a>00458     {
<a name="l00459"></a>00459       <span class="comment">/* Create entry and add useage time to it */</span>
<a name="l00460"></a>00460       entry = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Operand_Latency"</span>, buf);
<a name="l00461"></a>00461       <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (entry, <span class="stringliteral">"time"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1bae96f31ca512cf27a95ab6f96f4d89">MD_INT</a>, &amp;latency);
<a name="l00462"></a>00462       <span class="keywordflow">return</span> (entry);
<a name="l00463"></a>00463     }
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="keywordtype">void</span>
<a name="l00469"></a><a class="code" href="convert__hmdes_8c.html#8d13d90966ee0a9fba3c647d2514e29c">00469</a> <a class="code" href="convert__hmdes_8c.html#8d13d90966ee0a9fba3c647d2514e29c">convert_latency</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> * hmdes)
<a name="l00470"></a>00470 {
<a name="l00471"></a>00471   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html">Msymbol</a> *old_symbol;
<a name="l00472"></a>00472   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html">Hmdes_Latency</a> *old_latency;
<a name="l00473"></a>00473   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *op_lat, *target;
<a name="l00474"></a>00474   <span class="keywordtype">int</span> i;
<a name="l00475"></a>00475 
<a name="l00476"></a>00476   <span class="comment">/* Add all latenciess to the Operation/Operand latency sections */</span>
<a name="l00477"></a>00477   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#7edd02826d139fa007a4d90348e81e7c">latencies</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00478"></a>00478        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00479"></a>00479     {
<a name="l00480"></a>00480       <span class="comment">/* Get old latency for ease of use */</span>
<a name="l00481"></a>00481       old_latency = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html">Hmdes_Latency</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483       <span class="comment">/* Add to operation latency section */</span>
<a name="l00484"></a>00484       op_lat = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Operation_Latency"</span>, old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#4a4687a87bf5909e45c86f4a4cf27d2e">name</a>);
<a name="l00485"></a>00485 
<a name="l00486"></a>00486       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#d13b429ef4ce57f85b6e50cfc7e89ba4">max_src_operands</a>; i++)
<a name="l00487"></a>00487         {
<a name="l00488"></a>00488           target = <a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">add_op_lat</a> (md, <span class="stringliteral">"s"</span>, old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#9c05bb42cc63d70a71d1668b1a8eadd5">src</a>[i]);
<a name="l00489"></a>00489           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"src"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00490"></a>00490         }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#6227b0dc332b781877c35fdbf23d3772">max_dest_operands</a>; i++)
<a name="l00493"></a>00493         {
<a name="l00494"></a>00494           target = <a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">add_op_lat</a> (md, <span class="stringliteral">"d"</span>, old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#82cb8a6b2061340b09195b92aa9fa7ed">dest</a>[i]);
<a name="l00495"></a>00495           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"dest"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00496"></a>00496         }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#d1234881901cd6f69caf80f4238f874f">max_pred_operands</a>; i++)
<a name="l00499"></a>00499         {
<a name="l00500"></a>00500           target = <a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">add_op_lat</a> (md, <span class="stringliteral">"p"</span>, old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#17a40bd9a5638cc8a4ba5df27cdd9d77">pred</a>[i]);
<a name="l00501"></a>00501           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"pred"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#cdee5e7de7c4d871114a3983232d9766">max_src_syncs</a>; i++)
<a name="l00505"></a>00505         {
<a name="l00506"></a>00506           target = <a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">add_op_lat</a> (md, <span class="stringliteral">"ss"</span>, old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#d183d41dc190f76ea87c630feb827e2c">sync_src</a>[i]);
<a name="l00507"></a>00507           switch (i)
<a name="l00508"></a>00508             {
<a name="l00509"></a>00509             <span class="keywordflow">case</span> 0:
<a name="l00510"></a>00510               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"mem_src"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00511"></a>00511               <span class="keywordflow">break</span>;
<a name="l00512"></a>00512             <span class="keywordflow">case</span> 1:
<a name="l00513"></a>00513               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"ctrl_src"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00514"></a>00514               <span class="keywordflow">break</span>;
<a name="l00515"></a>00515             <span class="keywordflow">case</span> 2:
<a name="l00516"></a>00516               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"sync_src"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00517"></a>00517               <span class="keywordflow">break</span>;
<a name="l00518"></a>00518             <span class="keywordflow">default</span>:
<a name="l00519"></a>00519               <span class="keywordflow">if</span> (old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#d183d41dc190f76ea87c630feb827e2c">sync_src</a>[i] != 0)
<a name="l00520"></a>00520                 {
<a name="l00521"></a>00521                   <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Latency-&gt;%s: converting sync_src[%i] not "</span>
<a name="l00522"></a>00522                           <span class="stringliteral">"currently supported"</span>, op_lat-&gt;name, i);
<a name="l00523"></a>00523                 }
<a name="l00524"></a>00524             }
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527       <span class="keywordflow">for</span> (i = 0; i &lt; hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#fd6e7b12c8fd77bc052c69715ba2e9c2">max_dest_syncs</a>; i++)
<a name="l00528"></a>00528         {
<a name="l00529"></a>00529           target = <a class="code" href="convert__hmdes_8c.html#2bf1f437337eda2962b935e0bc407b8b">add_op_lat</a> (md, <span class="stringliteral">"sd"</span>, old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#64e42361d990eaaf8d3b62e159b1ab1d">sync_dest</a>[i]);
<a name="l00530"></a>00530           switch (i)
<a name="l00531"></a>00531             {
<a name="l00532"></a>00532             <span class="keywordflow">case</span> 0:
<a name="l00533"></a>00533               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"mem_dest"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00534"></a>00534               <span class="keywordflow">break</span>;
<a name="l00535"></a>00535             <span class="keywordflow">case</span> 1:
<a name="l00536"></a>00536               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"ctrl_dest"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00537"></a>00537               <span class="keywordflow">break</span>;
<a name="l00538"></a>00538             <span class="keywordflow">case</span> 2:
<a name="l00539"></a>00539               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (op_lat, <span class="stringliteral">"sync_dest"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, target);
<a name="l00540"></a>00540               <span class="keywordflow">break</span>;
<a name="l00541"></a>00541             <span class="keywordflow">default</span>:
<a name="l00542"></a>00542               <span class="keywordflow">if</span> (old_latency-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#64e42361d990eaaf8d3b62e159b1ab1d">sync_dest</a>[i] != 0)
<a name="l00543"></a>00543                 {
<a name="l00544"></a>00544                   <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Latency-&gt;%s: converting sync_dest[%i] not "</span>
<a name="l00545"></a>00545                           <span class="stringliteral">"currently supported"</span>, op_lat-&gt;name, i);
<a name="l00546"></a>00546                 }
<a name="l00547"></a>00547             }
<a name="l00548"></a>00548         }
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 
<a name="l00554"></a>00554 <span class="keywordtype">void</span>
<a name="l00555"></a><a class="code" href="convert__hmdes_8c.html#a238ad20977fd84a65677e7c336a7f5a">00555</a> <a class="code" href="convert__hmdes_8c.html#a238ad20977fd84a65677e7c336a7f5a">convert_res_tables</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> * hmdes)
<a name="l00556"></a>00556 {
<a name="l00557"></a>00557   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html">Msymbol</a> *old_symbol;
<a name="l00558"></a>00558   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html">Hmdes_Resource</a> *old_res;
<a name="l00559"></a>00559   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html">Hmdes_Res_Sub</a> *res_sub;
<a name="l00560"></a>00560   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html">Hmdes_Res_List</a> *res_list;
<a name="l00561"></a>00561   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html">Hmdes_Res_Node</a> *res_node;
<a name="l00562"></a>00562   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html">Hmdes_Res_Option</a> *res_option;
<a name="l00563"></a>00563   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *res_table, *res_usage, *tab_option, *resource;
<a name="l00564"></a>00564   <span class="keywordtype">int</span> time;
<a name="l00565"></a>00565   <span class="keywordtype">char</span> name_buf[20000], sub_buf[100];
<a name="l00566"></a>00566 
<a name="l00567"></a>00567   <span class="comment">/* Add all resources to the Resource section */</span>
<a name="l00568"></a>00568   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#194d8ae8e167cd72a67e1e02cc4ed2bd">resources</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00569"></a>00569        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00570"></a>00570     {
<a name="l00571"></a>00571       <span class="comment">/* Get old resource for ease of use */</span>
<a name="l00572"></a>00572       old_res = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html">Hmdes_Resource</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00573"></a>00573 
<a name="l00574"></a>00574       <span class="comment">/* Create resource for each subscript */</span>
<a name="l00575"></a>00575       for (res_sub = old_res-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html#bfaf104c2a6fc140cc5e496eb9ba8512">head</a>; res_sub != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; res_sub = res_sub-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#c5c4aed47688209d449559dd50b45976">next</a>)
<a name="l00576"></a>00576         {
<a name="l00577"></a>00577           sprintf (name_buf, <span class="stringliteral">"%s[%i]"</span>, old_res-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html#bb3acea2756d84fed3b9482e20a9746c">name</a>, res_sub-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#2ffdefd39ebe287898f0f8a653387b36">subscript</a>);
<a name="l00578"></a>00578           resource = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Resource"</span>, name_buf);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580           <span class="comment">/* Add slot annotations */</span>
<a name="l00581"></a>00581           <span class="keywordflow">if</span> (strcmp (old_res-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html#bb3acea2756d84fed3b9482e20a9746c">name</a>, <span class="stringliteral">"slot"</span>) == 0)
<a name="l00582"></a>00582             {
<a name="l00583"></a>00583               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (resource, <span class="stringliteral">"slot"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1bae96f31ca512cf27a95ab6f96f4d89">MD_INT</a>,
<a name="l00584"></a>00584                                      &amp;res_sub-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#2ffdefd39ebe287898f0f8a653387b36">subscript</a>);
<a name="l00585"></a>00585 
<a name="l00586"></a>00586             }
<a name="l00587"></a>00587         }
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590   <span class="comment">/* Add all reservation tables to the hmdes2, adding resource</span>
<a name="l00591"></a>00591 <span class="comment">   * usages and table options as necessary.</span>
<a name="l00592"></a>00592 <span class="comment">   */</span>
<a name="l00593"></a>00593   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#9ae40d45f69564985642878dd202a76b">res_lists</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00594"></a>00594        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00595"></a>00595     {
<a name="l00596"></a>00596       <span class="comment">/* Get old res_list for ease of use */</span>
<a name="l00597"></a>00597       res_list = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html">Hmdes_Res_List</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599       <span class="comment">/* Create reservation table for each res_list */</span>
<a name="l00600"></a>00600       res_table = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Reservation_Table"</span>, res_list-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html#85c71cd8dd014a46e6201d4b1016655a">name</a>);
<a name="l00601"></a>00601 
<a name="l00602"></a>00602       <span class="comment">/* Reservation table may be empty, start reservation table</span>
<a name="l00603"></a>00603 <span class="comment">       * with empty "use" field in case this happens</span>
<a name="l00604"></a>00604 <span class="comment">       */</span>
<a name="l00605"></a>00605       <a class="code" href="convert__hmdes_8c.html#51b19f66e703ea6bc42975c17d0f56f8">create_empty_field</a> (res_table, <span class="stringliteral">"use"</span>);
<a name="l00606"></a>00606 
<a name="l00607"></a>00607       <span class="comment">/* Point the slot_options node at head of resource list nodes</span>
<a name="l00608"></a>00608 <span class="comment">       * (So we can print out both slot and non-slot resources</span>
<a name="l00609"></a>00609 <span class="comment">       *  with one loop). </span>
<a name="l00610"></a>00610 <span class="comment">       */</span>
<a name="l00611"></a>00611       res_list-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html#5eba31ed560a7c235fa970afa85df1c3">slot_options</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#b606d85754067aa6ae42cde6ba5c2412">next</a> = res_list-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html#2d1075e173a779cec43a71c6eae14b24">head</a>;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613       <span class="comment">/* Create all the necessary resource usages and table options</span>
<a name="l00614"></a>00614 <span class="comment">       * for this reservation table.  </span>
<a name="l00615"></a>00615 <span class="comment">       */</span>
<a name="l00616"></a>00616       <span class="keywordflow">for</span> (res_node = res_list-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html#5eba31ed560a7c235fa970afa85df1c3">slot_options</a>; res_node != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00617"></a>00617            res_node = res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#b606d85754067aa6ae42cde6ba5c2412">next</a>)
<a name="l00618"></a>00618         {
<a name="l00619"></a>00619           <span class="comment">/* If have multiple options, create a table option */</span>
<a name="l00620"></a>00620           <span class="keywordflow">if</span> (res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#32ee36c2aaa489909591c3385181b0e9">num_options</a> &gt; 1)
<a name="l00621"></a>00621             {
<a name="l00622"></a>00622               <span class="comment">/* Create table option name */</span>
<a name="l00623"></a>00623               <span class="keywordflow">for</span> (res_option = res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#cd490d1bf7dd402b14cbc3b1f5d7282b">head</a>; res_option != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00624"></a>00624                    res_option = res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#3d45d17fa906af82ae8f4f68f3de25b1">next</a>)
<a name="l00625"></a>00625                 {
<a name="l00626"></a>00626                   <span class="keywordflow">if</span> (res_option == res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#cd490d1bf7dd402b14cbc3b1f5d7282b">head</a>)
<a name="l00627"></a>00627                     {
<a name="l00628"></a>00628                       sprintf (name_buf, <span class="stringliteral">"any_%s[%i"</span>,
<a name="l00629"></a>00629                                res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#07c78c96bd3b51bbfa561fe6e21c0fe0">resource</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html#bb3acea2756d84fed3b9482e20a9746c">name</a>,
<a name="l00630"></a>00630                                res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#cd91a2d2462669fcd7d087011b0fc60c">subscript</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#2ffdefd39ebe287898f0f8a653387b36">subscript</a>);
<a name="l00631"></a>00631                     }
<a name="l00632"></a>00632                   <span class="keywordflow">else</span>
<a name="l00633"></a>00633                     {
<a name="l00634"></a>00634                       sprintf (sub_buf, <span class="stringliteral">",%i"</span>,
<a name="l00635"></a>00635                                res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#cd91a2d2462669fcd7d087011b0fc60c">subscript</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#2ffdefd39ebe287898f0f8a653387b36">subscript</a>);
<a name="l00636"></a>00636                       strcat (name_buf, sub_buf);
<a name="l00637"></a>00637                     }
<a name="l00638"></a>00638                 }
<a name="l00639"></a>00639               sprintf (sub_buf, <span class="stringliteral">"]_t%i_%i"</span>, res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#13ecad11606ad33168a8009d6f8fb7a4">start_usage</a>,
<a name="l00640"></a>00640                        res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#08ce91bb6a2ca3c1c833ccd224d47baf">end_usage</a>);
<a name="l00641"></a>00641               strcat (name_buf, sub_buf);
<a name="l00642"></a>00642 
<a name="l00643"></a>00643               <span class="comment">/* If table option already exists, add to reservation</span>
<a name="l00644"></a>00644 <span class="comment">               * table but skip the rest of the stuff to prevent</span>
<a name="l00645"></a>00645 <span class="comment">               * adding multiple times */</span>
<a name="l00646"></a>00646               tab_option = <a class="code" href="convert__hmdes_8c.html#34bf787819d11144e052c7527984718a">find_entry_if_exists</a> (md, <span class="stringliteral">"Table_Option"</span>,
<a name="l00647"></a>00647                                                  name_buf);
<a name="l00648"></a>00648               <span class="keywordflow">if</span> (tab_option != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00649"></a>00649                 {
<a name="l00650"></a>00650                   <span class="comment">/* Add to Reservation table */</span>
<a name="l00651"></a>00651                   <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (res_table, <span class="stringliteral">"use"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>,
<a name="l00652"></a>00652                                          tab_option);
<a name="l00653"></a>00653                   <span class="keywordflow">continue</span>;
<a name="l00654"></a>00654                 }
<a name="l00655"></a>00655               <span class="keywordflow">else</span>
<a name="l00656"></a>00656                 {
<a name="l00657"></a>00657                   <span class="comment">/* Create tab_option */</span>
<a name="l00658"></a>00658                   tab_option = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Table_Option"</span>, name_buf);
<a name="l00659"></a>00659 
<a name="l00660"></a>00660                   <span class="comment">/* Add to Reservation table */</span>
<a name="l00661"></a>00661                   <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (res_table, <span class="stringliteral">"use"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>,
<a name="l00662"></a>00662                                          tab_option);
<a name="l00663"></a>00663                 }
<a name="l00664"></a>00664             }
<a name="l00665"></a>00665           <span class="keywordflow">else</span>
<a name="l00666"></a>00666             {
<a name="l00667"></a>00667               <span class="comment">/* Mark that there are no options */</span>
<a name="l00668"></a>00668               tab_option = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00669"></a>00669             }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671           <span class="comment">/* Add a resource usage for each option */</span>
<a name="l00672"></a>00672           <span class="keywordflow">for</span> (res_option = res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#cd490d1bf7dd402b14cbc3b1f5d7282b">head</a>; res_option != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00673"></a>00673                res_option = res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#3d45d17fa906af82ae8f4f68f3de25b1">next</a>)
<a name="l00674"></a>00674             {
<a name="l00675"></a>00675               sprintf (name_buf, <span class="stringliteral">"RU_%s[%i]_t%i_%i"</span>,
<a name="l00676"></a>00676                        res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#07c78c96bd3b51bbfa561fe6e21c0fe0">resource</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html#bb3acea2756d84fed3b9482e20a9746c">name</a>,
<a name="l00677"></a>00677                        res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#cd91a2d2462669fcd7d087011b0fc60c">subscript</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#2ffdefd39ebe287898f0f8a653387b36">subscript</a>,
<a name="l00678"></a>00678                        res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#13ecad11606ad33168a8009d6f8fb7a4">start_usage</a>, res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#08ce91bb6a2ca3c1c833ccd224d47baf">end_usage</a>);
<a name="l00679"></a>00679 
<a name="l00680"></a>00680               <span class="comment">/* Find res_usage entry if already created */</span>
<a name="l00681"></a>00681               res_usage = <a class="code" href="convert__hmdes_8c.html#34bf787819d11144e052c7527984718a">find_entry_if_exists</a> (md, <span class="stringliteral">"Resource_Usage"</span>,
<a name="l00682"></a>00682                                                 name_buf);
<a name="l00683"></a>00683               <span class="comment">/* Only add entry again if does'nt already exists */</span>
<a name="l00684"></a>00684               <span class="keywordflow">if</span> (res_usage == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00685"></a>00685                 {
<a name="l00686"></a>00686                   res_usage = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Resource_Usage"</span>, name_buf);
<a name="l00687"></a>00687 
<a name="l00688"></a>00688                   <span class="comment">/* Set the resource used */</span>
<a name="l00689"></a>00689                   sprintf (name_buf, <span class="stringliteral">"%s[%i]"</span>, res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#07c78c96bd3b51bbfa561fe6e21c0fe0">resource</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__resource__st.html#bb3acea2756d84fed3b9482e20a9746c">name</a>,
<a name="l00690"></a>00690                            res_option-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__option__st.html#cd91a2d2462669fcd7d087011b0fc60c">subscript</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__sub__st.html#2ffdefd39ebe287898f0f8a653387b36">subscript</a>);
<a name="l00691"></a>00691                   resource = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Resource"</span>, name_buf);
<a name="l00692"></a>00692                   <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (res_usage, <span class="stringliteral">"use"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, resource);
<a name="l00693"></a>00693 
<a name="l00694"></a>00694 
<a name="l00695"></a>00695                   <span class="comment">/* Set the times of usage */</span>
<a name="l00696"></a>00696                   <span class="keywordflow">if</span> (res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#13ecad11606ad33168a8009d6f8fb7a4">start_usage</a> &lt;= res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#08ce91bb6a2ca3c1c833ccd224d47baf">end_usage</a>)
<a name="l00697"></a>00697                     {
<a name="l00698"></a>00698                       <span class="keywordflow">for</span> (time = res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#13ecad11606ad33168a8009d6f8fb7a4">start_usage</a>;
<a name="l00699"></a>00699                            time &lt;= res_node-&gt;end_usage; time++)
<a name="l00700"></a>00700                         {
<a name="l00701"></a>00701                           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (res_usage, <span class="stringliteral">"time"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1bae96f31ca512cf27a95ab6f96f4d89">MD_INT</a>,
<a name="l00702"></a>00702                                                  &amp;time);
<a name="l00703"></a>00703                         }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705                     }
<a name="l00706"></a>00706                   <span class="keywordflow">else</span>
<a name="l00707"></a>00707                     {
<a name="l00708"></a>00708                       <span class="keywordflow">for</span> (time = res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#13ecad11606ad33168a8009d6f8fb7a4">start_usage</a>;
<a name="l00709"></a>00709                            time &gt;= res_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__node__st.html#08ce91bb6a2ca3c1c833ccd224d47baf">end_usage</a>; time--)
<a name="l00710"></a>00710                         {
<a name="l00711"></a>00711                           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (res_usage, <span class="stringliteral">"time"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#1bae96f31ca512cf27a95ab6f96f4d89">MD_INT</a>,
<a name="l00712"></a>00712                                                  &amp;time);
<a name="l00713"></a>00713                         }
<a name="l00714"></a>00714                     }
<a name="l00715"></a>00715                 }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717               <span class="comment">/* If part of an option, add to option, otherwise to</span>
<a name="l00718"></a>00718 <span class="comment">               * reservation table </span>
<a name="l00719"></a>00719 <span class="comment">               */</span>
<a name="l00720"></a>00720               <span class="keywordflow">if</span> (tab_option != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00721"></a>00721                 {
<a name="l00722"></a>00722                   <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (tab_option, <span class="stringliteral">"one_of"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>,
<a name="l00723"></a>00723                                          res_usage);
<a name="l00724"></a>00724                 }
<a name="l00725"></a>00725               <span class="keywordflow">else</span>
<a name="l00726"></a>00726                 {
<a name="l00727"></a>00727                   <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (res_table, <span class="stringliteral">"use"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>,
<a name="l00728"></a>00728                                          res_usage);
<a name="l00729"></a>00729                 }
<a name="l00730"></a>00730             }
<a name="l00731"></a>00731         }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 
<a name="l00734"></a>00734     }
<a name="l00735"></a>00735 }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="keywordtype">void</span>
<a name="l00739"></a><a class="code" href="convert__hmdes_8c.html#4fb3226ec52c93c25bbf1f7daddd8c23">00739</a> <a class="code" href="convert__hmdes_8c.html#4fb3226ec52c93c25bbf1f7daddd8c23">convert_operations</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> * hmdes)
<a name="l00740"></a>00740 {
<a name="l00741"></a>00741   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html">Msymbol</a> *old_symbol;
<a name="l00742"></a>00742   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html">Hmdes_Operation</a> *old_op;
<a name="l00743"></a>00743   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__node__st.html">Hmdes_Operation_Node</a> *op_node;
<a name="l00744"></a>00744   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__class__node__st.html">Hmdes_Class_Node</a> *class_node;
<a name="l00745"></a>00745   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD__Entry.html">MD_Entry</a> *pristine_op, *impact_op, *flag, *alt, *res_table, *format, *lat;
<a name="l00746"></a>00746   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__st.html">Hmdes_Flag</a> *old_flag;
<a name="l00747"></a>00747   <span class="keywordtype">char</span> name_buf[1000];
<a name="l00748"></a>00748   <span class="keywordtype">int</span> id;
<a name="l00749"></a>00749 
<a name="l00750"></a>00750   <span class="keywordflow">for</span> (old_symbol = hmdes-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html#7244cda8df1b26517a5e5371207355fc">operations</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__table__st.html#de6159e81bced21f9c5fb2149459aac3">head</a>; old_symbol != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00751"></a>00751        old_symbol = old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#3ae57a496e08aa6b3cfdaac96db12241">next_linear</a>)
<a name="l00752"></a>00752     {
<a name="l00753"></a>00753       <span class="comment">/* Get old op for ease of use */</span>
<a name="l00754"></a>00754       old_op = (<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html">Hmdes_Operation</a> *) old_symbol-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structmsymbol__st.html#9cf9b630400e233fe0d3e88fd9890a70">ptr</a>;
<a name="l00755"></a>00755 
<a name="l00756"></a>00756       <span class="comment">/* Create pristine op for old_op */</span>
<a name="l00757"></a>00757       sprintf (name_buf, <span class="stringliteral">"OP_%s"</span>, old_op-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html#fbe2e96895b480490df7a363822240ad">name</a>);
<a name="l00758"></a>00758       pristine_op = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Operation"</span>, name_buf);
<a name="l00759"></a>00759 
<a name="l00760"></a>00760       <span class="comment">/* Create numbered scheduling alternatives for pristine op */</span>
<a name="l00761"></a>00761       <span class="keywordtype">id</span> = 0;
<a name="l00762"></a>00762       <span class="keywordflow">for</span> (op_node = old_op-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html#a71caa844d56d1d29f24107be85231c5">head</a>; op_node != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; op_node = op_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__node__st.html#139fdf5d7486dd4ae3da84dca69ee66a">next</a>)
<a name="l00763"></a>00763         {
<a name="l00764"></a>00764           <span class="keywordflow">for</span> (class_node = op_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__node__st.html#a2fcf76ee1ff5e758fd606717182dcbf">class</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__class__st.html#48cad0fcb2f2e4e4aae44ddd577dc8a5">head</a>; class_node != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00765"></a>00765                class_node = class_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__class__node__st.html#4981097e77036642db9206eedbd169fe">next</a>)
<a name="l00766"></a>00766             {
<a name="l00767"></a>00767               <span class="comment">/* Create alt name from op name */</span>
<a name="l00768"></a>00768               sprintf (name_buf, <span class="stringliteral">"ALT_%s_%i"</span>, old_op-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html#fbe2e96895b480490df7a363822240ad">name</a>, <span class="keywordtype">id</span>);
<a name="l00769"></a>00769 
<a name="l00770"></a>00770               <span class="comment">/* Create scheduling alt */</span>
<a name="l00771"></a>00771               alt = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"Scheduling_Alternative"</span>, name_buf);
<a name="l00772"></a>00772 
<a name="l00773"></a>00773               <span class="comment">/* Add scheduling alt to pristine op */</span>
<a name="l00774"></a>00774               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (pristine_op, <span class="stringliteral">"alt"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, alt);
<a name="l00775"></a>00775 
<a name="l00776"></a>00776               <span class="comment">/* Link alternative to operation format */</span>
<a name="l00777"></a>00777               format = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Operation_Format"</span>,
<a name="l00778"></a>00778                                    class_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__class__node__st.html#e87968a8c806d06fecee0f8fa8190c17">io_item</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__io__item__st.html#8607878410c73a0b45ee724f1eaebbbc">name</a>);
<a name="l00779"></a>00779 
<a name="l00780"></a>00780               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (alt, <span class="stringliteral">"format"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, format);
<a name="l00781"></a>00781 
<a name="l00782"></a>00782               <span class="comment">/* Link alternative to operation latency */</span>
<a name="l00783"></a>00783               lat = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Operation_Latency"</span>,
<a name="l00784"></a>00784                                 class_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__class__node__st.html#14db391f2f28c8230bea429d32f23aa0">latency</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__latency__st.html#4a4687a87bf5909e45c86f4a4cf27d2e">name</a>);
<a name="l00785"></a>00785 
<a name="l00786"></a>00786               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (alt, <span class="stringliteral">"latency"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, lat);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788               <span class="comment">/* Link alternative to reservation table */</span>
<a name="l00789"></a>00789               res_table = <a class="code" href="convert__hmdes_8c.html#f58daa7180bb89cd7f1db6c839e73d24">find_entry</a> (md, <span class="stringliteral">"Reservation_Table"</span>,
<a name="l00790"></a>00790                                       class_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__class__node__st.html#e7634e6cf1a90dc4ca88aaf1d236886b">res_list</a>-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__res__list__st.html#85c71cd8dd014a46e6201d4b1016655a">name</a>);
<a name="l00791"></a>00791 
<a name="l00792"></a>00792               <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (alt, <span class="stringliteral">"resv"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, res_table);
<a name="l00793"></a>00793 
<a name="l00794"></a>00794               <span class="comment">/* Add links to alt flags */</span>
<a name="l00795"></a>00795               <span class="keywordflow">for</span> (old_flag = op_node-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__node__st.html#43aa083fb6062a5fe0d2de614b9aac4a">mdes_flags</a>.<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__list__st.html#91f4e2c2f8124253fae2de37ba0bec9a">head</a>; old_flag != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00796"></a>00796                    old_flag = old_flag-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__st.html#aa41ef0173585f7ef4e4f385e13b0e02">next</a>)
<a name="l00797"></a>00797                 {
<a name="l00798"></a>00798                   <span class="comment">/* Add flag to IMPACT_Alt_Flag section */</span>
<a name="l00799"></a>00799                   flag = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"IMPACT_Alt_Flag"</span>, old_flag-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__st.html#b25f2d4a0cd5b8252470d004e0a8c296">name</a>);
<a name="l00800"></a>00800 
<a name="l00801"></a>00801                   <span class="comment">/* Add to flags field */</span>
<a name="l00802"></a>00802                   <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (alt, <span class="stringliteral">"flags"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, flag);
<a name="l00803"></a>00803                 }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 
<a name="l00806"></a>00806               <span class="comment">/* Go to next id */</span>
<a name="l00807"></a>00807               <span class="keywordtype">id</span>++;
<a name="l00808"></a>00808             }
<a name="l00809"></a>00809         }
<a name="l00810"></a>00810 
<a name="l00811"></a>00811 
<a name="l00812"></a>00812       <span class="comment">/* Create impact op for old_op */</span>
<a name="l00813"></a>00813       impact_op = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"IMPACT_Operation"</span>, old_op-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html#fbe2e96895b480490df7a363822240ad">name</a>);
<a name="l00814"></a>00814 
<a name="l00815"></a>00815       <span class="comment">/* Link to pristine op */</span>
<a name="l00816"></a>00816       <a class="code" href="convert__hmdes_8c.html#26b31203d2cfec0406e930f19e4d534f">add_value_to_field</a> (impact_op, <span class="stringliteral">"op"</span>, 0, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, pristine_op);
<a name="l00817"></a>00817 
<a name="l00818"></a>00818       <span class="comment">/* Add all the operation flags to the impact_op */</span>
<a name="l00819"></a>00819       <span class="keywordflow">for</span> (old_flag = old_op-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__operation__st.html#8879a131601f287239c317188d8551d1">op_flags</a>.<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__list__st.html#91f4e2c2f8124253fae2de37ba0bec9a">head</a>; old_flag != <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00820"></a>00820            old_flag = old_flag-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__st.html#aa41ef0173585f7ef4e4f385e13b0e02">next</a>)
<a name="l00821"></a>00821         {
<a name="l00822"></a>00822           <span class="comment">/* Add flag to IMPACT_Operation_Flag section */</span>
<a name="l00823"></a>00823           flag = <a class="code" href="convert__hmdes_8c.html#06be49cfc7f58ccb3e02f1e051feb60e">add_entry</a> (md, <span class="stringliteral">"IMPACT_Operation_Flag"</span>, old_flag-&gt;<a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__flag__st.html#b25f2d4a0cd5b8252470d004e0a8c296">name</a>);
<a name="l00824"></a>00824 
<a name="l00825"></a>00825           <span class="comment">/* Add to flags field */</span>
<a name="l00826"></a>00826           <a class="code" href="convert__hmdes_8c.html#9865cd40b273eaa099d6d14d1c38c186">append_value_to_field</a> (impact_op, <span class="stringliteral">"flags"</span>, <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8h.html#832ab6cc636240c071152b8bd2824ff9">MD_LINK</a>, flag);
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828     }
<a name="l00829"></a>00829 }
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 <span class="keywordtype">void</span>
<a name="l00832"></a><a class="code" href="convert__hmdes_8c.html#1c8abf12365ede1d73d0fb9183fb6cdd">00832</a> <a class="code" href="convert__hmdes_8c.html#1c8abf12365ede1d73d0fb9183fb6cdd">convert_hmdes</a> (<a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> * md, <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> * hmdes)
<a name="l00833"></a>00833 {
<a name="l00834"></a>00834   <a class="code" href="convert__hmdes_8c.html#f202962df85bdaaedd37e868417af372">convert_Parameters</a> (md, hmdes);
<a name="l00835"></a>00835 
<a name="l00836"></a>00836   <a class="code" href="convert__hmdes_8c.html#e050552b2cb01a9ba04eda87064a6e4e">convert_format</a> (md, hmdes);
<a name="l00837"></a>00837 
<a name="l00838"></a>00838   <a class="code" href="convert__hmdes_8c.html#8d13d90966ee0a9fba3c647d2514e29c">convert_latency</a> (md, hmdes);
<a name="l00839"></a>00839 
<a name="l00840"></a>00840   <a class="code" href="convert__hmdes_8c.html#a238ad20977fd84a65677e7c336a7f5a">convert_res_tables</a> (md, hmdes);
<a name="l00841"></a>00841 
<a name="l00842"></a>00842   <a class="code" href="convert__hmdes_8c.html#4fb3226ec52c93c25bbf1f7daddd8c23">convert_operations</a> (md, hmdes);
<a name="l00843"></a>00843 }
<a name="l00844"></a>00844 
<a name="l00845"></a>00845 
<a name="l00846"></a>00846 <span class="keywordtype">int</span>
<a name="l00847"></a><a class="code" href="convert__hmdes_8c.html#647f21a28344e1d9c643f4115516d7c9">00847</a> <a class="code" href="convert__hmdes_8c.html#647f21a28344e1d9c643f4115516d7c9">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv, <span class="keywordtype">char</span> **envp)
<a name="l00848"></a>00848 {
<a name="l00849"></a>00849   <span class="keywordtype">char</span> *hmdes_file_name;
<a name="l00850"></a>00850   <span class="keywordtype">char</span> *structure_file_name;
<a name="l00851"></a>00851   <span class="keywordtype">char</span> *hmdes2_file_name;
<a name="l00852"></a>00852   FILE *out, *structure;
<a name="l00853"></a>00853   <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/structhmdes__st.html">Hmdes</a> *hmdes;
<a name="l00854"></a>00854   <span class="keywordtype">int</span> num_args, i;
<a name="l00855"></a>00855   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/structMD.html">MD</a> *md;
<a name="l00856"></a>00856   <span class="keywordtype">int</span> errors;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858   <a class="code" href="convert__hmdes_8c.html#289c5900d90626d909f0a85d5a0ed61d">program_name</a> = argv[0];
<a name="l00859"></a>00859 
<a name="l00860"></a>00860   num_args = 0;
<a name="l00861"></a>00861   <span class="keywordflow">for</span> (i = 1; argv[i] != 0; i++)
<a name="l00862"></a>00862     {
<a name="l00863"></a>00863       <span class="keywordflow">if</span> ((argv[i][0] != <span class="charliteral">'-'</span>) ||
<a name="l00864"></a>00864           ((argv[i][1] != <span class="charliteral">'D'</span>) &amp;&amp; (strcmp (argv[i], <span class="stringliteral">"-verbose"</span>) != 0)))
<a name="l00865"></a>00865         num_args++;
<a name="l00866"></a>00866     }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868   <span class="keywordflow">if</span> (num_args != 3)
<a name="l00869"></a>00869     <a class="code" href="convert__hmdes_8c.html#e5ad5cbeccaedc03a48d3c7eaa803e79">print_usage</a> ();
<a name="l00870"></a>00870 
<a name="l00871"></a>00871   <span class="comment">/* Make sure first three arguments don't start with '-' */</span>
<a name="l00872"></a>00872   <span class="keywordflow">if</span> ((argv[1][0] == <span class="charliteral">'-'</span>) || (argv[2][0] == <span class="charliteral">'-'</span>) || (argv[3][0] == <span class="charliteral">'-'</span>))
<a name="l00873"></a>00873     <a class="code" href="convert__hmdes_8c.html#e5ad5cbeccaedc03a48d3c7eaa803e79">print_usage</a> ();
<a name="l00874"></a>00874 
<a name="l00875"></a>00875   hmdes_file_name = argv[1];
<a name="l00876"></a>00876   structure_file_name = argv[2];
<a name="l00877"></a>00877   hmdes2_file_name = argv[3];
<a name="l00878"></a>00878 
<a name="l00879"></a>00879   <span class="comment">/* Make sure input and output files are not the same */</span>
<a name="l00880"></a>00880   <span class="keywordflow">if</span> (strcmp (hmdes_file_name, hmdes2_file_name) == 0)
<a name="l00881"></a>00881     <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#4b5d684504778c8d474321a099a3c4b2">H_punt</a> (<span class="stringliteral">"May not read and write the same file '%s'\n"</span>, hmdes_file_name);
<a name="l00882"></a>00882 
<a name="l00883"></a>00883   <span class="keywordflow">if</span> (strcmp (structure_file_name, hmdes2_file_name) == 0)
<a name="l00884"></a>00884     <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#4b5d684504778c8d474321a099a3c4b2">H_punt</a> (<span class="stringliteral">"May not read and write the same file '%s'\n"</span>,
<a name="l00885"></a>00885             structure_file_name);
<a name="l00886"></a>00886 
<a name="l00887"></a>00887   hmdes = <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#3157c981faa1f80fffce64fe8a1685b2">create_hmdes</a> (hmdes_file_name, argv, envp);
<a name="l00888"></a>00888 
<a name="l00889"></a>00889 
<a name="l00890"></a>00890   <span class="comment">/* Open lmdes2 structure file */</span>
<a name="l00891"></a>00891   <span class="keywordflow">if</span> ((structure = fopen (structure_file_name, <span class="stringliteral">"r"</span>)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00892"></a>00892     <a class="code" href="convert__hmdes_8c.html#c8ccfa451c1bd1740a1b720ba5b4c3a9">L_punt</a> (<span class="stringliteral">"Unable to open lmdes2 structure file '%s'."</span>,
<a name="l00893"></a>00893             structure_file_name);
<a name="l00894"></a>00894 
<a name="l00895"></a>00895   <span class="comment">/* Read in lmdes2 structure file */</span>
<a name="l00896"></a>00896   md = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#0574c5322b5fd565ffc5adfc2e6e8614">MD_read_md</a> (structure, structure_file_name);
<a name="l00897"></a>00897 
<a name="l00898"></a>00898   <span class="comment">/* Close the input file */</span>
<a name="l00899"></a>00899   fclose (structure);
<a name="l00900"></a>00900 
<a name="l00901"></a>00901   <span class="comment">/* Convert hmdes to hmdes2 format */</span>
<a name="l00902"></a>00902   <a class="code" href="convert__hmdes_8c.html#1c8abf12365ede1d73d0fb9183fb6cdd">convert_hmdes</a> (md, hmdes);
<a name="l00903"></a>00903 
<a name="l00904"></a>00904   <span class="comment">/* Make sure format is correct */</span>
<a name="l00905"></a>00905   errors = <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#c8488b1c9a90e9b52187a89338183b2c">MD_check_md</a> (stderr, md);
<a name="l00906"></a>00906 
<a name="l00907"></a>00907   <span class="keywordflow">if</span> (errors != 0)
<a name="l00908"></a>00908     {
<a name="l00909"></a>00909       fprintf (stderr,
<a name="l00910"></a>00910                <span class="stringliteral">"***\n*** Please tell John Gyllenhaal:\n***    %i hmdes "</span>
<a name="l00911"></a>00911                <span class="stringliteral">"conversion errors when converting\n***    %s\n***\n"</span>,
<a name="l00912"></a>00912                errors, hmdes_file_name);
<a name="l00913"></a>00913     }
<a name="l00914"></a>00914 
<a name="l00915"></a>00915   <span class="comment">/* Open output file */</span>
<a name="l00916"></a>00916   <span class="keywordflow">if</span> ((out = fopen (hmdes2_file_name, <span class="stringliteral">"w"</span>)) == <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/i__global_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00917"></a>00917     <a class="codeRef" doxygen="libhmdes.tag:../../hmdes/html/" href="../../hmdes/html/hmdes_8c.html#4b5d684504778c8d474321a099a3c4b2">H_punt</a> (<span class="stringliteral">"Error opening '%s' for writing"</span>, hmdes2_file_name);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919   <span class="comment">/* </span>
<a name="l00920"></a>00920 <span class="comment">   * Write hmdes2 file out </span>
<a name="l00921"></a>00921 <span class="comment">   */</span>
<a name="l00922"></a>00922 
<a name="l00923"></a>00923   <span class="comment">/* Print out section and entry declarations so, combined with the</span>
<a name="l00924"></a>00924 <span class="comment">   * output of MD_print_md, the output will be a legal hmdes file.</span>
<a name="l00925"></a>00925 <span class="comment">   */</span>
<a name="l00926"></a>00926   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#f8bca4aa4b831162fb2d76ba4a86d6aa">MD_print_md_declarations</a> (out, md, 80);
<a name="l00927"></a>00927 
<a name="l00928"></a>00928   <span class="comment">/* Put blank line after declarations */</span>
<a name="l00929"></a>00929   putc (<span class="charliteral">'\n'</span>, out);
<a name="l00930"></a>00930 
<a name="l00931"></a>00931   <span class="comment">/* Print out field declations and entry contents for each section */</span>
<a name="l00932"></a>00932   <a class="codeRef" doxygen="libimpact.tag:../../../library/html/" href="../../../library/html/md_8c.html#a9df1e553926805d90c54daf8439c069">MD_print_md</a> (out, md, 80);
<a name="l00933"></a>00933 
<a name="l00934"></a>00934   <span class="comment">/* Close the output file */</span>
<a name="l00935"></a>00935   fclose (out);
<a name="l00936"></a>00936 
<a name="l00937"></a>00937   <span class="keywordflow">return</span> (0);
<a name="l00938"></a>00938 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Aug 30 17:58:48 2014 for convert_hmdes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
